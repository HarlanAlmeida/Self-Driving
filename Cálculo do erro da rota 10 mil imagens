import cv2
import numpy as np
import matplotlib.pyplot as plt

from scipy.interpolate import interp1d

gps_path = np.array([
[-64.86672794117646, -25.3081],
[-64.86672794117646,-25.30817],
[-64.86672794117646,-23.69811],
[-64.86672794117646,-21.48427],
[-64.86672794117646,-19.67295],
[-64.86672794117646,-17.45911],
[-64.86672794117646,-16.45283],
[-64.86672794117646,-16.45283],
[-64.86672794117646,-13.83647],
[-64.86672794117646,-13.83647],
[-64.86672794117646,-12.62893],
[-64.86672794117646,-10.61635],
[-64.86672794117646,-8.805031],
[-64.65992647058823,-6.389937],
[-64.65992647058823,-4.377358],
[-64.65992647058823,-1.962264],
[-64.4531250 ,      2.6666666],
[-64.65992647058823,2.6666666],
[-64.453125,4.679245283018872],
[-64.453125,6.691823899371073],
[-64.453125,8.301886792452834],
[-64.453125,10.31446540880503],
[-64.453125,12.52830188679245],
[-64.453125,14.94339622641509],
[-64.453125,17.35849056603777],
[-64.453125,19.77358490566038],
[-64.453125,22.59119496855346],
[-64.453125,25.00628930817610],
[-64.65992647058823,26.817610],
[-64.453125,28.62893081761007],
[-64.453125,30.64150943396227],
[-64.65992647058823,33.056603],
[-64.453125,35.47169811320755],
[-64.453125,37.88679245283019],
[-64.65992647058823,40.301886],
[-64.453125,42.91823899371070],
[-64.453125,45.13207547169811],
[-64.24632352941177,47.748427],
[-64.65992647058823,49.962264],
[-64.453125,51.97484276729560],
[-64.24632352941177,54.188679],
[-64.65992647058823,56.201257],
[-64.453125,58.61635220125787],
[-64.453125,60.83018867924528],
[-64.453125,62.84276729559748],
[-64.453125,65.05660377358491],
[-64.453125,67.47169811320755],
[-64.453125,69.08176100628931],
[-64.453125,71.09433962264151],
[-64.24632352941177,72.704402],
[-63.62591911764706,74.515723],
[-63.21231617647059,76.327044],
[-62.798713235294116,78.13836],
[-62.17830882352941,80.150943],
[-61.14430147058823,82.767295],
[-59.903492647058826,85.18238],
[-58.86948529411765,86.993710],
[-57.21507352941177,89.207547],
[-55.974264705882355,90.81761],
[-54.73345588235294,92.427672],
[-53.07904411764706,94.037735],
[-52.045036764705884,95.44654],
[-50.390625,96.85534591194968],
[-48.32261029411765,98.465408],
[-46.04779411764706,99.672955],
[-44.393382352941174,100.8805],
[-42.7389705882353,101.283018],
[-41.08455882352941,102.49056],
[-39.43014705882353,103.09433],
[-37.15533088235294,104.10062],
[-34.67371323529412,104.50314],
[-32.8125,105.106918238993730],
[-30.744485294117652,105.1069],
[-28.676470588235297,105.5094],
[-26.40165441176471,105.50943],
[-24.126838235294123,105.5094],
[-21.231617647058826,105.5094],
[-19.16360294117647,105.71069],
[-16.888786764705884,105.5094],
[-14.407169117647065,105.7106],
[-11.925551470588239,105.5094],
[-9.650735294117652,105.50943],
[-7.169117647058826,105.50943],
[-4.894301470588246,105.50943],
[-1.999080882352942,105.50943],
[0.8961397058823479,105.71069],
[3.791360294117638,105.308176],
[6.272977941176464,105.308176],
[8.961397058823522,105.308176],
[12.063419117647058,105.30817],
[14.338235294117638,105.30817],
[16.819852941176464,105.50943],
[19.715073529411754,105.10691],
[22.19669117647058,105.308176],
[24.057904411764696,105.30817],
[26.953125,105.50943396226415],
[29.434742647058812,105.30817],
[31.916360294117638,105.50943],
[34.81158088235293,105.308176],
[36.87959558823529,105.308176],
[39.15441176470587,105.308176],
[41.015624999999986,105.30817],
[43.08363970588235,105.308176],
[44.944852941176464,105.30817],
[47.42647058823529,105.308176],
[50.11488970588235,105.308176],
[52.38970588235293,105.308176],
[54.250919117647044,105.30817],
[56.52573529411765,105.308176],
[59.42095588235293,105.106918],
[61.69577205882351,105.106918],
[64.38419117647058,105.106918],
[66.2454044117647,105.1069182],
[68.52022058823528,105.106918],
[70.79503676470588,105.106918],
[73.48345588235293,104.905660],
[76.171875,104.90566037735849],
[78.65349264705881,104.905660],
[81.34191176470588,104.905660],
[84.03033088235293,104.905660],
[85.68474264705881,104.905660],
[88.16636029411762,104.905660],
[91.68198529411762,104.905660],
[91.68198529411762,104.905660],
[94.3704044117647,104.9056603],
[96.64522058823528,104.905660],
[99.33363970588235,104.905660],
[102.43566176470588,104.50314],
[104.71047794117646,104.10062],
[106.77849264705881,103.69811],
[109.26011029411762,103.09433],
[111.328125,102.2893081761006],
[113.60294117647058,101.48427],
[115.67095588235293,100.67924],
[117.94577205882351,99.672955],
[120.01378676470588,98.465408],
[122.08180147058823,97.459119],
[123.73621323529412,96.251572],
[125.59742647058823,94.842767],
[127.04503676470586,93.433962],
[128.90625,91.823899371069190],
[130.56066176470586,90.817610],
[131.59466911764704,89.207547],
[133.0422794117647,87.3962264],
[134.69669117647058,85.182389],
[136.14430147058823,82.566037],
[137.1783088235294,80.3522012],
[138.21231617647058,78.138364],
[138.83272058823528,75.924528],
[139.453125,73.50943396226415],
[139.65992647058823,70.691823],
[140.0735294117647,67.8742138],
[139.86672794117646,66.465408],
[139.86672794117646,64.050314],
[140.0735294117647,61.6352201],
[139.86672794117646,59.018867],
[140.0735294117647,56.6037735],
[139.86672794117646,54.389937],
 ])

car_path = np.array([  
[-64.10198285333217,  -29.270139178744],
[-63.841112662339214, -27.308107485715],
[-63.0656985084222,   -24.786482246434],
[-62.5487557391442,   -23.105398753580],
[-61.77454098840416,  -21.144518487600],
[-62.283687637031804, -19.180759653996],
[-62.53556230419743,  -16.937204047266],
[-62.2722933068505,   -13.853682407633],
[-62.781439955478156, -11.889923574029],
[-63.80393116385286,   -9.925013313375],
[-64.05400672625301,   -6.840340246693],
[-63.021320590873984,  -4.038918234286],
[-63.52926783632465,   -1.514414427380],
[-63.26599883897773,    1.569107212251],
[-62.74665726334576,    4.371680651707],
[-62.48458766917582,    6.894457318038],
[-62.221918373417395,   9.697606471020],
[-62.72866621569107,   12.782855251226],
[-62.97874177809122,   15.867528317909],
[-61.94605564271218,   18.668950330315],
[-62.19613120511234,   21.753623396997],
[-62.445607065923994,  25.118668950330],
[-62.696282329912634,  27.922969530361],
[-62.69088501561623,   30.446321910217],
[-62.68308889496588,   34.091164236675],
[-62.934963562131486,  36.334719843405],
[-63.441111702816684,  39.700341110263],
[-63.435714388520275,  42.223693490119],
[-63.42971737263539,   45.027418356625],
[-63.423120655161995,  48.111515709782],
[-63.67379591915064,   50.915816289814],
[-62.89778206364513,   53.717814015745],
[-62.63511276788671,   56.520963168727],
[-62.628516050413324,  59.605060521884],
[-62.36584675465488,   62.408209674865],
[-62.359250037181496,  65.492307028022],
[-62.09658074142308,   68.295456181004],
[-62.0899840239497,    71.379553534161],
[-62.081588201710844,  75.304768347270],
[-60.536157208173215,  77.824666445976],
[-58.221908778191974,  79.782092430806],
[-55.13824321017862,   81.457418788410],
[-52.82579388496286,   82.573727313288],
[-50.50974635021614,   85.372270758070],
[-50.50434903591974,   87.895623137926],
[-49.98560716187627,   90.417824090732],
[-47.15681476897096,   92.934843621813],
[-44.58829286547015,   93.770203946516],
[-42.27704294343134,   94.325767498092],
[-39.193377375418,     96.001093855697],
[-36.113310016935564,  95.994185293397],
[-32.776570378579635,  95.986701017573],
[-28.926486180476605,  95.978065314699],
[-24.819130000911546,  96.249226384950],
[-21.227517187447535,  95.400048935649],
[-17.377432989344506,  95.391413232775],
[-14.813108996963095,  94.264166150923],
[-11.992712426296677,  92.855970868895],
[-8.658971295883191,   91.446624159818],
[-6.60859156483734,    90.040156018365],
[-4.299140747564039,   89.754602109990],
[-0.1953827775299004,  88.343528260337],
[3.1425562640030194,   88.896788957814],
[6.738966690174976,    90.290591401718],
[10.584852977158569,   88.319348292289],
[13.924591123456949,   89.713726449718],
[16.238239851849727,   91.390779947897],
[16.238239851849727,   91.390779947897],
[20.088324049952732,   91.382144245023],
[21.363289627081542,   87.454050864289],
[23.412469954950424,   85.486837749535],
[26.23706443673629,    86.041249874062],
[29.3177314968072,     86.314713798413],
[31.36811122785302,    84.908245656961],
[34.1915063064619,     84.901912808186],
[37.015501086659285,   85.175952446062],
[40.866184986350774,   85.447689229839],
[43.94745174801018,    86.001525640841],
[46.25930137163745,    86.837461679068],
[49.33936873011987,    86.830553116769],
[52.933980051526376,   87.383238100721],
[56.52859137293284,    87.935923084673],
[59.10011178437611,    90.173145842628],
[62.18017914285855,    90.166237280329],
[63.71121729827239,    85.957195699419],
[67.04675753345138,    85.388966450294],
[70.12862399669925,    86.223175347946],
[73.46776244140918,    87.337181018725],
[76.80570148294211,    87.890441716202],
[80.39731429640611,    87.041264266900],
[83.9901265130471,     86.752831790900],
[87.58413813286509,    87.025144288202],
[90.40333530035454,    85.056204032873],
[90.91008314262825,    81.970955252666],
[90.13227018235727,    78.327840066782],
[89.35685602844023,    75.806214827501],
[87.81142503490264,    73.286316728795],
[86.00872205990302,    70.486621856963],
[83.69567303309873,    69.089940845435],
[81.3790257967635,     66.011024914002],
[78.80930449008574,    64.614919615999],
[76.75352744474351,    63.498035377596],
[74.43867931317375,    61.260236906115],
[72.37990375988909,    58.741490234459],
[73.6554690386064,     55.093769340376],
])

# Considerando que os pontos de GPS são os pontos de referência
f = interp1d(np.linspace(0, 1, len(gps_path)), gps_path, axis=0, kind='linear')
car_path_interp = f(np.linspace(0, 1, len(car_path)))

# Calcular distâncias
distances = np.linalg.norm(car_path_interp - car_path, axis=1)

# Calcular métricas de erro
mae = np.mean(distances)
mse = np.mean(distances**2)
rmse = np.sqrt(mse)

print(f"MAE: {mae}")
print(f"MSE: {mse}")
print(f"RMSE: {rmse}")

# Plots
plt.figure(figsize=(12, 6))

plt.subplot(1, 2, 1)
plt.plot(gps_path[:, 0], gps_path[:, 1], label='Rota GPS', marker='o')
plt.plot(car_path[:, 0], car_path[:, 1], label='Caminho Carro', marker='x')
plt.legend()
plt.title('Comparação de Rotas')
plt.xlabel('Longitude')
plt.ylabel('Latitude')

plt.subplot(1, 2, 2)
plt.plot(distances, marker='o')
plt.title('Erro entre Pontos Correspondentes')
plt.xlabel('Índice do Ponto')
plt.ylabel('Distância')

plt.tight_layout()
plt.show()

