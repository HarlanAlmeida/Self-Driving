import cv2
import numpy as np
import matplotlib.pyplot as plt

from scipy.interpolate import interp1d

gps_path = np.array([
[-64.86672794117646, -25.3081],
[-64.86672794117646,-25.30817],
[-64.86672794117646,-23.69811],
[-64.86672794117646,-21.48427],
[-64.86672794117646,-19.67295],
[-64.86672794117646,-17.45911],
[-64.86672794117646,-16.45283],
[-64.86672794117646,-16.45283],
[-64.86672794117646,-13.83647],
[-64.86672794117646,-13.83647],
[-64.86672794117646,-12.62893],
[-64.86672794117646,-10.61635],
[-64.86672794117646,-8.805031],
[-64.65992647058823,-6.389937],
[-64.65992647058823,-4.377358],
[-64.65992647058823,-1.962264],
[-64.4531250 ,      2.6666666],
[-64.65992647058823,2.6666666],
[-64.453125,4.679245283018872],
[-64.453125,6.691823899371073],
[-64.453125,8.301886792452834],
[-64.453125,10.31446540880503],
[-64.453125,12.52830188679245],
[-64.453125,14.94339622641509],
[-64.453125,17.35849056603777],
[-64.453125,19.77358490566038],
[-64.453125,22.59119496855346],
[-64.453125,25.00628930817610],
[-64.65992647058823,26.817610],
[-64.453125,28.62893081761007],
[-64.453125,30.64150943396227],
[-64.65992647058823,33.056603],
[-64.453125,35.47169811320755],
[-64.453125,37.88679245283019],
[-64.65992647058823,40.301886],
[-64.453125,42.91823899371070],
[-64.453125,45.13207547169811],
[-64.24632352941177,47.748427],
[-64.65992647058823,49.962264],
[-64.453125,51.97484276729560],
[-64.24632352941177,54.188679],
[-64.65992647058823,56.201257],
[-64.453125,58.61635220125787],
[-64.453125,60.83018867924528],
[-64.453125,62.84276729559748],
[-64.453125,65.05660377358491],
[-64.453125,67.47169811320755],
[-64.453125,69.08176100628931],
[-64.453125,71.09433962264151],
[-64.24632352941177,72.704402],
[-63.62591911764706,74.515723],
[-63.21231617647059,76.327044],
[-62.798713235294116,78.13836],
[-62.17830882352941,80.150943],
[-61.14430147058823,82.767295],
[-59.903492647058826,85.18238],
[-58.86948529411765,86.993710],
[-57.21507352941177,89.207547],
[-55.974264705882355,90.81761],
[-54.73345588235294,92.427672],
[-53.07904411764706,94.037735],
[-52.045036764705884,95.44654],
[-50.390625,96.85534591194968],
[-48.32261029411765,98.465408],
[-46.04779411764706,99.672955],
[-44.393382352941174,100.8805],
[-42.7389705882353,101.283018],
[-41.08455882352941,102.49056],
[-39.43014705882353,103.09433],
[-37.15533088235294,104.10062],
[-34.67371323529412,104.50314],
[-32.8125,105.106918238993730],
[-30.744485294117652,105.1069],
[-28.676470588235297,105.5094],
[-26.40165441176471,105.50943],
[-24.126838235294123,105.5094],
[-21.231617647058826,105.5094],
[-19.16360294117647,105.71069],
[-16.888786764705884,105.5094],
[-14.407169117647065,105.7106],
[-11.925551470588239,105.5094],
[-9.650735294117652,105.50943],
[-7.169117647058826,105.50943],
[-4.894301470588246,105.50943],
[-1.999080882352942,105.50943],
[0.8961397058823479,105.71069],
[3.791360294117638,105.308176],
[6.272977941176464,105.308176],
[8.961397058823522,105.308176],
[12.063419117647058,105.30817],
[14.338235294117638,105.30817],
[16.819852941176464,105.50943],
[19.715073529411754,105.10691],
[22.19669117647058,105.308176],
[24.057904411764696,105.30817],
[26.953125,105.50943396226415],
[29.434742647058812,105.30817],
[31.916360294117638,105.50943],
[34.81158088235293,105.308176],
[36.87959558823529,105.308176],
[39.15441176470587,105.308176],
[41.015624999999986,105.30817],
[43.08363970588235,105.308176],
[44.944852941176464,105.30817],
[47.42647058823529,105.308176],
[50.11488970588235,105.308176],
[52.38970588235293,105.308176],
[54.250919117647044,105.30817],
[56.52573529411765,105.308176],
[59.42095588235293,105.106918],
[61.69577205882351,105.106918],
[64.38419117647058,105.106918],
[66.2454044117647,105.1069182],
[68.52022058823528,105.106918],
[70.79503676470588,105.106918],
[73.48345588235293,104.905660],
[76.171875,104.90566037735849],
[78.65349264705881,104.905660],
[81.34191176470588,104.905660],
[84.03033088235293,104.905660],
[85.68474264705881,104.905660],
[88.16636029411762,104.905660],
[91.68198529411762,104.905660],
[91.68198529411762,104.905660],
[94.3704044117647,104.9056603],
[96.64522058823528,104.905660],
[99.33363970588235,104.905660],
[102.43566176470588,104.50314],
[104.71047794117646,104.10062],
[106.77849264705881,103.69811],
[109.26011029411762,103.09433],
[111.328125,102.2893081761006],
[113.60294117647058,101.48427],
[115.67095588235293,100.67924],
[117.94577205882351,99.672955],
[120.01378676470588,98.465408],
[122.08180147058823,97.459119],
[123.73621323529412,96.251572],
[125.59742647058823,94.842767],
[127.04503676470586,93.433962],
[128.90625,91.823899371069190],
[130.56066176470586,90.817610],
[131.59466911764704,89.207547],
[133.0422794117647,87.3962264],
[134.69669117647058,85.182389],
[136.14430147058823,82.566037],
[137.1783088235294,80.3522012],
[138.21231617647058,78.138364],
[138.83272058823528,75.924528],
[139.453125,73.50943396226415],
[139.65992647058823,70.691823],
[140.0735294117647,67.8742138],
[139.86672794117646,66.465408],
[139.86672794117646,64.050314],
[140.0735294117647,61.6352201],
[139.86672794117646,59.018867],
[140.0735294117647,56.6037735],
[139.86672794117646,54.389937],
 ])

car_path = np.array([  
[-64.86672794117646,  -25.30810000000],
[-63.888888888888886, -28.84246069431],
[-63.374485596707814, -26.97669956929],
[-63.374485596707814, -25.11189770449],
[-62.345679012345684, -23.01207708615],
[-62.34567901234568, -20.681074755148],
[-62.34567901234567, -19.049373123447],
[-62.345679012345684, -17.41767149174],
[-62.345679012345684, -15.31976939384],
[-63.1172839506173, -13.2233061862691],
[-63.63168724279836, -11.359463581685],
[-64.14609053497944, -9.0294205109019],
[-63.11728395061728, -6.9295998925628],
[-64.14609053497944, -4.1343156157970],
[-63.11728395061728, -1.8013947643577],
[-62.6028806584362, 1.229867526163825],
[-62.60288065843622, 3.56086985716615],
[-62.60288065843623, 6.35807265436895],
[-63.88888888888891, 8.91977706792521],
[-62.345679012345656, 10.787456713382],
[-62.602880658436234, 13.584179880476],
[-62.86008230452677, 16.6140032806699],
[-62.6028806584362, 19.17858547488170],
[-62.860082304526756, 21.742208408870],
[-63.11728395061728, 24.3058313428680],
[-62.60288065843622, 27.1039934002890],
[-63.88888888888888, 30.1318982800460],
[-63.37448559670781, 33.3962608036680],
[-63.8888888888889, 36.19250434065250],
[-63.88888888888892, 38.2904064385540],
[-62.860082304526806, 40.856427523090],
[-62.60288065843622, 43.4210097173060],
[-62.86008230452681, 45.9846326512990],
[-62.6028806584362, 48.31611461241090],
[-62.60288065843627, 51.3464176427130],
[-62.088477366255205, 53.678379233930],
[-62.088477366255134, 56.009381564930],
[-62.86008230452677, 58.5720452387110],
[-61.31687242798357, 60.9059253503690],
[-59.259259259259295, 63.240764722240],
[-56.17283950617286, 64.1789212159580],
[-53.08641975308647, 64.6508772434690],
[-51.54320987654323, 66.5185568889270],
[-51.028806584362215, 69.083618713240],
[-50.51440329218105, 72.3479812368700],
[-47.17078189300412, 73.9859180599920],
[-44.34156378600819, 74.4573944573940],
[-40.997942386831234, 75.396030581210],
[-36.36831275720161, 76.3370648555834],
[-32.25308641975305, 76.8109394035320],
[-29.166666666666742, 76.816694964843],
[-25.051440329218053, 77.290569512791],
[-21.450617283950663, 76.831083868120],
[-18.106995884773607, 76.371118593340],
[-15.277777777777779, 74.977793125941],
[-12.19135802469141, 73.8180475217512],
[-9.10493827160493, 72.65830191756123],
[-6.018518518518569, 71.2654560802709],
[-2.932098765432052, 70.3388107091811],
[-0.1028806584362627, 69.411685707982],
[2.7263374485596046, 70.8155630377853],
[7.3559670781892805, 71.7565973121529],
[10.44238683127572, 70.13065124176238],
[13.528806584362144, 71.0688077354744],
[15.843621399176968, 72.7048260381594],
[19.701646090534908, 73.1782209559988],
[20.730452674897094, 69.6836359799323],
[22.530864197530875, 67.8221915258952],
[25.617283950617292, 68.5272477865071],
[29.218106995884796, 68.7670628411369],
[33.59053497942382, 67.60971538749322],
[37.70576131687244, 67.61738946924137],
[41.04938271604932, 68.32292535996247],
[44.90740740740739, 68.79632027780181],
[48.251028806584316, 70.2011568678235],
[53.652263374485614, 70.2112291001180],
[55.70987654320979, 70.21506614099201],
[58.79629629629632, 71.38632286780404],
[62.91152263374481, 72.55949811505374],
[62.911522633744895, 69.0629946185502],
[65.22633744855963, 68.83421105643335],
[68.05555555555554, 68.14018628833449],
[71.39917695473248, 69.54502287835629],
[76.02880658436217, 70.25295691962367],
[80.65843621399173, 69.56228956228964],
[85.5452674897119, 70.037603000566007],
[89.66049382716048, 69.11287614991328],
[91.20370370370364, 66.31855113336604],
[91.20370370370367, 63.05514786996278],
[89.66049382716042, 60.95436799140511],
[88.11728395061724, 57.92118718044652],
[86.31687242798355, 56.51922837108030],
[83.23045267489712, 53.94937024566663],
[80.40123456790127, 51.84619221656277],
[77.05761316872427, 50.44135562654088],
[74.48559670781887, 48.57175746064642],
[72.6851851851852, 46.237397718879310],
[73.97119341563788, 42.27709190672161],
])

# Considerando que os pontos de GPS são os pontos de referência
f = interp1d(np.linspace(0, 1, len(gps_path)), gps_path, axis=0, kind='linear')
car_path_interp = f(np.linspace(0, 1, len(car_path)))

# Calcular distâncias
distances = np.linalg.norm(car_path_interp - car_path, axis=1)

# Calcular métricas de erro
mae = np.mean(distances)
mse = np.mean(distances**2)
rmse = np.sqrt(mse)

print(f"MAE: {mae}")
print(f"MSE: {mse}")
print(f"RMSE: {rmse}")

# Plots
plt.figure(figsize=(12, 6))

plt.subplot(1, 2, 1)
plt.plot(gps_path[:, 0], gps_path[:, 1], label='Rota GPS', marker='o')
plt.plot(car_path[:, 0], car_path[:, 1], label='Caminho Carro', marker='x')
plt.legend()
plt.title('Comparação de Rotas')
plt.xlabel('Longitude')
plt.ylabel('Latitude')

plt.subplot(1, 2, 2)
plt.plot(distances, marker='o')
plt.title('Erro entre Pontos Correspondentes')
plt.xlabel('Índice do Ponto')
plt.ylabel('Distância')

plt.tight_layout()
plt.show()

